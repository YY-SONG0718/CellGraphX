Starting hyperparameter optimization with Optuna...
Running Optuna study...
[I 2025-08-27 15:04:53,440] Using an existing study with name 'trial_optuna' instead of creating a new one.
Using an existing study with name 'trial_optuna' instead of creating a new one.
Initializing model...
Loading data...
Loading data from /nfs/research/irene/ysong/RESULTS/GeneCellType/GeneSpectra/MTG/CellGraphX/CellGraphX/data/mtg_all_sp_wilcox_data_with_og_ct_name.pt ...
/nfs/research/irene/ysong/RESULTS/GeneCellType/GeneSpectra/MTG/CellGraphX/CellGraphX/data/data_loader.py:21: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(data_path)
Split train val and test species
This is the HeteroData you are working with:
HeteroData(
  species_origin_index={
    0='H.sapiens',
    1='H.sapiens',
    2='H.sapiens',
    3='H.sapiens',
    4='H.sapiens',
    5='H.sapiens',
    6='H.sapiens',
    7='H.sapiens',
    8='H.sapiens',
    9='H.sapiens',
    10='H.sapiens',
    11='H.sapiens',
    12='H.sapiens',
    13='H.sapiens',
    14='H.sapiens',
    15='H.sapiens',
    16='H.sapiens',
    17='H.sapiens',
    18='H.sapiens',
    19='H.sapiens',
    20='H.sapiens',
    21='H.sapiens',
    22='H.sapiens',
    23='H.sapiens',
    24='M.mulatta',
    25='M.mulatta',
    26='M.mulatta',
    27='M.mulatta',
    28='M.mulatta',
    29='M.mulatta',
    30='M.mulatta',
    31='M.mulatta',
    32='M.mulatta',
    33='M.mulatta',
    34='M.mulatta',
    35='M.mulatta',
    36='M.mulatta',
    37='M.mulatta',
    38='M.mulatta',
    39='M.mulatta',
    40='M.mulatta',
    41='M.mulatta',
    42='M.mulatta',
    43='M.mulatta',
    44='M.mulatta',
    45='M.mulatta',
    46='M.mulatta',
    47='M.mulatta',
    48='C.jacchus',
    49='C.jacchus',
    50='C.jacchus',
    51='C.jacchus',
    52='C.jacchus',
    53='C.jacchus',
    54='C.jacchus',
    55='C.jacchus',
    56='C.jacchus',
    57='C.jacchus',
    58='C.jacchus',
    59='C.jacchus',
    60='C.jacchus',
    61='C.jacchus',
    62='C.jacchus',
    63='C.jacchus',
    64='C.jacchus',
    65='C.jacchus',
    66='C.jacchus',
    67='C.jacchus',
    68='C.jacchus',
    69='C.jacchus',
    70='C.jacchus',
    71='C.jacchus',
    72='P.troglodytes',
    73='P.troglodytes',
    74='P.troglodytes',
    75='P.troglodytes',
    76='P.troglodytes',
    77='P.troglodytes',
    78='P.troglodytes',
    79='P.troglodytes',
    80='P.troglodytes',
    81='P.troglodytes',
    82='P.troglodytes',
    83='P.troglodytes',
    84='P.troglodytes',
    85='P.troglodytes',
    86='P.troglodytes',
    87='P.troglodytes',
    88='P.troglodytes',
    89='P.troglodytes',
    90='P.troglodytes',
    91='P.troglodytes',
    92='P.troglodytes',
    93='P.troglodytes',
    94='P.troglodytes',
    95='P.troglodytes',
    96='G.gorilla',
    97='G.gorilla',
    98='G.gorilla',
    99='G.gorilla',
    100='G.gorilla',
    101='G.gorilla',
    102='G.gorilla',
    103='G.gorilla',
    104='G.gorilla',
    105='G.gorilla',
    106='G.gorilla',
    107='G.gorilla',
    108='G.gorilla',
    109='G.gorilla',
    110='G.gorilla',
    111='G.gorilla',
    112='G.gorilla',
    113='G.gorilla',
    114='G.gorilla',
    115='G.gorilla',
    116='G.gorilla',
    117='G.gorilla',
    118='G.gorilla',
    119='G.gorilla',
  },
  cell_type_index_mapping={
    Astro=0,
    Chandelier=1,
    Endo=2,
    L2-3 IT=3,
    L4 IT=4,
    L5 ET=5,
    L5 IT=6,
    L5-6 NP=7,
    L6 CT=8,
    L6 IT=9,
    L6 IT Car3=10,
    L6b=11,
    Lamp5=12,
    Lamp5_Lhx6=13,
    Micro-PVM=14,
    OPC=15,
    Oligo=16,
    Pax6=17,
    Pvalb=18,
    Sncg=19,
    Sst=20,
    Sst Chodl=21,
    VLMC=22,
    Vip=23,
  },
  test_species='G.gorilla',
  val_species='M.mulatta',
  cell_type={
    x=[120, 120],
    y=[120],
    train_mask=[120],
    val_mask=[120],
    test_mask=[120],
  },
  gene={ x=[92549, 29954] },
  orthologous_group={ x=[14948, 14948] },
  (gene, is_wilcox_marker_of, cell_type)={
    edge_index=[2, 17520],
    edge_weights=[17520],
  },
  (cell_type, rev_is_wilcox_marker_of, gene)={
    edge_index=[2, 17520],
    edge_weights=[17520],
  },
  (gene, is_in, orthologous_group)={ edge_index=[2, 49548] },
  (orthologous_group, rev_is_in, gene)={ edge_index=[2, 49548] }
)
Initializing trainer...
hidden_channels: 93, dropout: 0.2770757284887594, lr: 0.009877982963384694, weight_decay: 0.00012635746248075525
2025-08-27 15:05:17,009 - INFO - Epoch 1/100
2025-08-27 15:06:09,945 - INFO - Train Loss: 115.4266 | Train Acc: 0.0556 | Val Acc: 0.0417 | Test Acc: 0.0417
2025-08-27 15:06:10,704 - INFO - Checkpoint saved to ./logs/optuna_trial_4/best.pt
2025-08-27 15:06:11,440 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:06:11,440 - INFO - Epoch 2/100
2025-08-27 15:07:02,111 - INFO - Train Loss: 430.9692 | Train Acc: 0.0417 | Val Acc: 0.0417 | Test Acc: 0.0417
2025-08-27 15:07:02,803 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:07:02,803 - INFO - Epoch 3/100
2025-08-27 15:07:53,440 - INFO - Train Loss: 519.5023 | Train Acc: 0.0972 | Val Acc: 0.0833 | Test Acc: 0.0833
2025-08-27 15:07:54,199 - INFO - Checkpoint saved to ./logs/optuna_trial_4/best.pt
2025-08-27 15:07:54,865 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:07:54,865 - INFO - Epoch 4/100
2025-08-27 15:08:45,701 - INFO - Train Loss: 430.6615 | Train Acc: 0.0833 | Val Acc: 0.0833 | Test Acc: 0.0833
2025-08-27 15:08:46,437 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:08:46,437 - INFO - Epoch 5/100
2025-08-27 15:09:37,355 - INFO - Train Loss: 543.1707 | Train Acc: 0.0556 | Val Acc: 0.0417 | Test Acc: 0.0417
2025-08-27 15:09:38,070 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:09:38,071 - INFO - Epoch 6/100
2025-08-27 15:10:29,311 - INFO - Train Loss: 435.2831 | Train Acc: 0.0417 | Val Acc: 0.0417 | Test Acc: 0.0417
2025-08-27 15:10:29,993 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:10:29,993 - INFO - Epoch 7/100
2025-08-27 15:11:21,359 - INFO - Train Loss: 305.5622 | Train Acc: 0.1250 | Val Acc: 0.1250 | Test Acc: 0.0833
2025-08-27 15:11:22,146 - INFO - Checkpoint saved to ./logs/optuna_trial_4/best.pt
2025-08-27 15:11:22,889 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:11:22,890 - INFO - Epoch 8/100
2025-08-27 15:12:14,298 - INFO - Train Loss: 282.2570 | Train Acc: 0.1250 | Val Acc: 0.0833 | Test Acc: 0.0833
2025-08-27 15:12:15,040 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:12:15,041 - INFO - Epoch 9/100
2025-08-27 15:13:06,717 - INFO - Train Loss: 211.7590 | Train Acc: 0.1250 | Val Acc: 0.1250 | Test Acc: 0.0833
2025-08-27 15:13:07,457 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:13:07,457 - INFO - Epoch 10/100
2025-08-27 15:13:58,127 - INFO - Train Loss: 169.9776 | Train Acc: 0.1250 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:13:58,812 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:13:58,812 - INFO - Epoch 11/100
2025-08-27 15:14:48,799 - INFO - Train Loss: 105.3254 | Train Acc: 0.1250 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:14:49,498 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:14:49,498 - INFO - Epoch 12/100
2025-08-27 15:15:40,569 - INFO - Train Loss: 99.7438 | Train Acc: 0.1389 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:15:41,321 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:15:41,321 - INFO - Epoch 13/100
2025-08-27 15:16:32,833 - INFO - Train Loss: 92.4352 | Train Acc: 0.1667 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:16:33,551 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:16:33,551 - INFO - Epoch 14/100
2025-08-27 15:17:24,649 - INFO - Train Loss: 84.7883 | Train Acc: 0.1944 | Val Acc: 0.1250 | Test Acc: 0.1667
2025-08-27 15:17:25,358 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:17:25,358 - INFO - Epoch 15/100
2025-08-27 15:18:16,529 - INFO - Train Loss: 77.0827 | Train Acc: 0.2222 | Val Acc: 0.1250 | Test Acc: 0.1667
2025-08-27 15:18:17,254 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:18:17,255 - INFO - Epoch 16/100
2025-08-27 15:19:08,512 - INFO - Train Loss: 70.3405 | Train Acc: 0.2083 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:19:09,241 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:19:09,242 - INFO - Epoch 17/100
2025-08-27 15:20:00,064 - INFO - Train Loss: 64.6597 | Train Acc: 0.2361 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:20:00,799 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:20:00,800 - INFO - Epoch 18/100
2025-08-27 15:20:51,431 - INFO - Train Loss: 59.4610 | Train Acc: 0.2083 | Val Acc: 0.1667 | Test Acc: 0.0833
2025-08-27 15:20:52,133 - INFO - Checkpoint saved to ./logs/optuna_trial_4/best.pt
2025-08-27 15:20:52,859 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:20:52,859 - INFO - Epoch 19/100
2025-08-27 15:21:44,711 - INFO - Train Loss: 54.8214 | Train Acc: 0.2222 | Val Acc: 0.1667 | Test Acc: 0.1250
2025-08-27 15:21:45,423 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:21:45,423 - INFO - Epoch 20/100
2025-08-27 15:22:36,280 - INFO - Train Loss: 50.8438 | Train Acc: 0.2222 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:22:36,945 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:22:36,946 - INFO - Epoch 21/100
2025-08-27 15:23:28,606 - INFO - Train Loss: 46.9691 | Train Acc: 0.2222 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:23:29,315 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:23:29,315 - INFO - Epoch 22/100
2025-08-27 15:24:20,877 - INFO - Train Loss: 46.5223 | Train Acc: 0.2222 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:24:21,561 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:24:21,562 - INFO - Epoch 23/100
2025-08-27 15:25:12,666 - INFO - Train Loss: 46.0161 | Train Acc: 0.2222 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:25:13,320 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:25:13,320 - INFO - Epoch 24/100
2025-08-27 15:26:03,985 - INFO - Train Loss: 45.4636 | Train Acc: 0.2222 | Val Acc: 0.1250 | Test Acc: 0.1250
2025-08-27 15:26:04,751 - INFO - Checkpoint saved to ./logs/optuna_trial_4/latest.pt
2025-08-27 15:26:04,752 - INFO - Epoch 25/100
